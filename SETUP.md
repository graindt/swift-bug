# Chrome Bug Reporter Extension - Setup Guide

## 项目概述

Chrome Bug Reporter 是一个功能完整的Chrome浏览器扩展，用于保存和复现Web应用的Bug。该扩展使用原生Chrome Extension API开发，无需任何外部框架。

## 文件结构

```
chrome-bug-reporter/
├── manifest.json              # 扩展配置文件
├── background/                # 后台服务
│   └── background.js         # 后台脚本，处理数据存储和通信
├── content/                  # 内容脚本
│   └── content.js           # 页面数据收集和控制台监听
├── popup/                   # 弹出窗口
│   ├── popup.html           # 弹出窗口HTML
│   ├── popup.css            # 弹出窗口样式
│   └── popup.js             # 弹出窗口逻辑
├── options/                 # 设置页面
│   ├── options.html         # 设置页面HTML
│   ├── options.css          # 设置页面样式
│   └── options.js           # 设置页面逻辑
├── utils/                   # 工具函数
│   └── storage.js           # 存储和数据处理工具
├── icons/                   # 图标文件
│   └── create-icons.html    # 图标生成工具
├── test-page.html           # 测试页面
├── SETUP.md                 # 本文件 - 安装说明
├── README.md                # 项目说明
└── REQUIREMENTS.md          # 详细需求文档
```

## 安装步骤

### 1. 准备图标文件

由于Git无法直接提交二进制图标文件，需要先生成图标：

1. 在Chrome中打开 `icons/create-icons.html`
2. 点击"Generate Icons"按钮
3. 逐个下载所需的图标文件：
   - icon-16.png
   - icon-32.png
   - icon-48.png
   - icon-128.png
4. 将下载的图标文件放入 `icons/` 目录

### 2. 安装扩展

1. 打开Chrome浏览器
2. 进入扩展管理页面：
   - 方法1：在地址栏输入 `chrome://extensions/`
   - 方法2：菜单 → 更多工具 → 扩展程序
3. 开启"开发者模式"（右上角开关）
4. 点击"加载已解压的扩展程序"
5. 选择项目根目录（包含manifest.json的文件夹）
6. 扩展安装完成，会在浏览器工具栏显示🐛图标

### 3. 验证安装

1. 在Chrome中打开 `test-page.html`
2. 点击扩展图标，应该看到弹出窗口
3. 点击"保存Bug快照"测试基本功能
4. 在测试页面上进行各种操作，生成控制台日志和存储数据
5. 测试导出/导入功能

## 核心功能说明

### 1. Bug快照保存
- 自动收集当前页面URL、标题、时间戳
- 获取页面所有Cookies
- 收集LocalStorage和SessionStorage数据
- 捕获控制台输出（日志、警告、错误）
- 截取页面截图
- 记录浏览器和页面基本信息

### 2. 数据管理
- 本地存储所有Bug报告（最多50个）
- 自动清理过期数据
- 支持单个或批量删除
- 显示存储空间使用情况

### 3. 导出功能
- 将Bug报告导出为JSON文件
- 包含版本信息确保兼容性
- 自动生成有意义的文件名

### 4. 导入还原
- 导入之前导出的Bug报告文件
- 自动跳转到Bug发生的原始页面
- 还原所有Cookies、LocalStorage、SessionStorage
- 重新加载页面应用所有更改

### 5. 设置选项
- 配置数据收集偏好
- 调整存储限制
- 管理扩展行为

## 使用说明

### 保存Bug快照
1. 在发生Bug的页面点击扩展图标🐛
2. 点击"保存Bug快照"按钮
3. 等待数据收集完成
4. 快照自动保存到本地存储

### 查看已保存的Bug
1. 点击扩展图标查看Bug列表
2. 显示最近5个Bug报告
3. 每个Bug显示标题、时间、域名
4. 提供查看、导出、删除操作

### 导出Bug报告
1. 在Bug列表中点击"导出"按钮
2. 选择保存位置
3. 文件自动命名为：`bug-report-{domain}-{date}-{timestamp}.json`

### 导入并还原Bug
1. 点击"导入Bug"按钮
2. 选择之前导出的JSON文件
3. 确认还原操作
4. 扩展自动跳转并还原环境

### 访问设置
1. 点击扩展图标
2. 点击"设置"按钮
3. 或右键扩展图标选择"选项"

## 技术特性

### Chrome Extension API使用
- **Manifest V3** - 使用最新的扩展API格式
- **Service Worker** - 后台脚本使用Service Worker
- **Content Scripts** - 自动注入页面进行数据收集
- **Storage API** - 本地数据持久化存储
- **Cookies API** - 读取和设置页面Cookies
- **Downloads API** - 文件下载功能
- **Tabs API** - 页面导航和管理
- **Scripting API** - 动态脚本注入

### 数据收集能力
- **完整页面状态** - URL、标题、时间戳等
- **用户会话数据** - Cookies、本地存储、会话存储
- **控制台输出** - 所有级别的日志信息
- **错误捕获** - JavaScript错误和Promise拒绝
- **页面截图** - 可视化页面状态
- **浏览器信息** - 用户代理等环境信息

### 安全特性
- **数据隐私** - 敏感信息自动脱敏处理
- **本地存储** - 所有数据只存储在本地
- **权限最小化** - 只请求必需的权限
- **数据清理** - 支持完全数据清除

## 故障排除

### 扩展无法加载
- 检查manifest.json语法是否正确
- 确保所有图标文件存在
- 查看Chrome扩展管理页面的错误信息
- 重新加载扩展程序

### 功能异常
- 打开Chrome开发者工具查看控制台错误
- 检查扩展是否有足够权限
- 确认在HTTPS页面上测试（某些功能需要安全上下文）
- 尝试刷新页面重新加载内容脚本

### 数据收集问题
- 某些网站可能限制扩展访问
- 跨域限制可能影响部分功能
- 隐私模式下功能可能受限
- 检查扩展权限设置

### 性能问题
- 大量控制台日志可能影响性能
- 在设置中调整日志数量限制
- 定期清理旧的Bug报告
- 避免在性能敏感页面过度使用

## 开发说明

### 代码结构
- 使用ES6+语法和现代JavaScript特性
- 模块化设计，职责分离清晰
- 错误处理和用户反馈完善
- 遵循Chrome扩展最佳实践

### 扩展开发
- 所有文件使用UTF-8编码
- JavaScript代码遵循严格模式
- CSS使用现代布局技术
- HTML符合语义化标准

### 调试技巧
- 使用Chrome开发者工具调试popup和options页面
- 后台脚本可在扩展管理页面点击"检查视图"调试
- 内容脚本错误会显示在页面控制台
- 使用console.log进行调试输出

## 更新日志

### v1.0.0 (初始版本)
- ✅ 基础扩展架构搭建
- ✅ Bug快照保存功能
- ✅ 数据导出/导入功能
- ✅ 用户界面设计
- ✅ 设置页面开发
- ✅ 控制台日志捕获
- ✅ 存储数据收集
- ✅ Cookie管理
- ✅ 页面截图功能
- ✅ 错误处理机制

## 许可证

此项目作为示例代码提供，可自由使用和修改。

## 支持

如有问题或建议，请查看项目文档或提交Issue。
